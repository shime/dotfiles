#!/usr/bin/env bash
WALLPAPERS="$1"
ALIST=( `ls -w1 $WALLPAPERS` )
RANGE=${#ALIST[@]}

function changeWallpaper(){
  let "number = $RANDOM"
  let LASTNUM="`cat $WALLPAPERS/.last` + $number"
  let "number = $LASTNUM % $RANGE"
  if [ $number -eq `cat $WALLPAPERS/.last` ]; then
    changeWallpaper
  fi
  echo $number > $WALLPAPERS/.last
  nitrogen --set-zoom-fill --save $WALLPAPERS/${ALIST[$number]}
}

while true
do
  changeWallpaper
  sleep 300 # change it every 5 minutes
done
